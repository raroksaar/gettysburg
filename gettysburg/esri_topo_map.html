<!DOCTYPE html>
<html>
<head>
<H2>
   <title>Topographic map</title>
   	<div style="text-align: center;">
	Area topographic map <br>
</H2>
<H3>
   	<div style="text-align: center;">
	<a href="https://library.nps.gov/gettysburg">Gettysburg visitor brochure</a>
</H3>
    </div>

   <meta charset="utf-8" />
   <meta name="viewport" content="width=device-width, initial-scale=1.0">
   <link rel="stylesheet" href="https://unpkg.com/leaflet@1.7.1/dist/leaflet.css" />
   <script src="https://unpkg.com/leaflet@1.7.1/dist/leaflet.js"></script>
   <script src="https://unpkg.com/esri-leaflet@2.5.3/dist/esri-leaflet.js"></script>
   

</head>

<H4>
<div style="text-align: center;">
Click anywhere on the map to get links to Google, Bing and OpenStreetMap maps <br> showing their markers, pictures  and annotations.
<br>
</H4>
<body>
   <div id="map" style="height: 700px;"></div>
   <script>
       //var map = L.map('map').setView([39.760354, -77.662354], 10);

	   // Imagery
	   // Terrain
	   // Topographic
	   // Streets
	   // Outdoor
	const queryString = window.location.search;
    const urlParams = new URLSearchParams(queryString);
	const place = urlParams.get('place'); // returns null if not found	
	
	if (place === "shiloh") {
		console.log("shiloh");
		//const coords = "[35.151511, -88.322072]"
		var map = L.map('map').setView([35.151511, -88.322072], 10);
	} else if (place === "gettysburg") {
		console.log("gettysburg");
		//const coords = "[39.81169, -77.22599]"
		var map = L.map('map').setView([39.81169, -77.22599], 10);
	} else {
		console.log("Good evening");
		//default to Gettysburg
		var map = L.map('map').setView([39.81169, -77.22599], 10);  
	}
        L.esri.basemapLayer('Topographic').addTo(map);


	   var parks = L.esri.featureLayer({
		   url: 'https://services.arcgis.com/.../FeatureServer/0',
		   style: function () {
			   return { color: '#70ca49', weight: 2 };
		   }
		}).addTo(map);

		parks.bindPopup(function (layer) {
			return 'Park Name: ' + layer.feature.properties.NAME;
			});
		
	

		// rectangle pin 39.851075, -77.210884
		L.marker([39.846594, -77.210884]).addTo(map)
			.bindPopup('Extent of park brochure map<br> <a href="https://library.nps.gov/gettysburg/esri_topo_map.html">Reset map</a>');
			// 	<a href="https://library.nps.gov/gettysburg/esri_topo_map.html">Current Esri topographic map of Gettysburg</a>

		var shilo_polygon = L.polygon([
			[35.166508, -88.368908],
			[35.166508, -88.29828],	
			[35.112716, -88.29828],
			[35.112716, -88.368908]
		]).addTo(map);	
		
		
		var polygon = L.polygon([
			[39.854422, -77.264744],
			[39.854422, -77.157304],
			[39.757233, -77.157304],
			[39.757233, -77.264744]
		]).addTo(map);
		
		// Emmitsburg 39.704425, -77.32667
		L.marker([39.704425, -77.32667]).addTo(map)
			.bindPopup('Confederate advance through Emmitsburg<br> <a href="https://www.emmitsburg.net/archive_list/articles/history/civil_war/confederate_invasion.htm">Emmitsburg Historical Society account</a>')
		    //.openPopup();
	   
	   const visitor_icon = L.icon({
			iconUrl: 'images/logo.png',
			iconSize: [20, 30],
			iconAnchor: [20, 25],
			popupAnchor: [0, 0]
	    });

	VisitorCentermarker = L.marker([39.81169, -77.22599],{icon: visitor_icon}).addTo(map); 
		VisitorCentermarker.bindPopup('<a href="https://library.nps.gov/gettysburg">Gettysburg visitor brochure</a>');

	ShilohVisitorCentermarker = L.marker([35.151511, -88.322072],{icon: visitor_icon}).addTo(map); 
		ShilohVisitorCentermarker.bindPopup('<a href="https://library.nps.gov/shiloh">Shiloh visitor brochure</a>');
		
	FtDonaldsonmarker = L.marker([36.485720, -87.847979],{icon: visitor_icon}).addTo(map);
	FtDonaldsonmarker.bindPopup('Fort Donelson');	
	
	const popup = L.popup();
	
	var googlelink = "";
	var coords = "";
	var link ="";
	var url ="";
	
	// add OpenStreetMap links, like https://www.openstreetmap.org/search?query=39.818232%2C+-77.280064&zoom=13
      map.on('click', function(e) {
	     coords = e.latlng.toString().substring(7,e.latlng.toString().length-1);
		 url = 'https://www.google.com/maps/place/' + coords;
		 link = '<a href="' + url + '" >Google maps link</a>';
		 googlelink = coords + '<br>' + link;
		 
		 opencoords = coords.replace(' ','');
		 openurl = 'https://www.openstreetmap.org/search?query=' + opencoords + '#map=16';
	     openlink = '<a href="' + openurl + '" >OpenStreetMap link</a>';
		 
		 bingcoords = coords.replace(', ','~');
		 bingurl = 'https://www.bing.com/maps/search?cp=' + bingcoords + '&lvl=15';
	     binglink = '<a href="' + bingurl + '" >Bing maps link</a>';

		
      });
	
	function onMapClick(e) {
		popup
			.setLatLng(e.latlng)
			.setContent(googlelink + '<br>' + binglink + '<br>' + openlink )
			.openOn(map)
	}

	map.on('click', onMapClick);
		
   </script>
</body>
</html>